<?php

namespace App\Http\Controllers\Admin;

use App\Blog;
use App\Portfolio;
use App\Skills;
use App\Slider;
use App\Uslugy;
use Illuminate\Http\Request;

use App\Http\Requests;
use App\Http\Controllers\Controller;
use Illuminate\Support\Facades\Auth;
use Menu;


class AdminController extends \App\Http\Controllers\Controller
{
    protected $port_rep; //Репозиторий Портфолио
    protected $b_rep; // Репозиторий Статьи
    protected $user; // Пользователи
    protected $con_rep; // Контакты
    protected $skills_rep; // Знания
    protected $foo_rep; // Футер
    protected $rez_rep; // Резюме
    protected $usl_rep; // Услуги
    protected $filter_rep; // Фильтер
    protected $tech_rep; // Технологии
    protected $log_rep; // Логотип
    protected $m_rep; // Меню
    protected $s_rep; // Слайдер
    protected $pr_rep; // Преимущества

    protected $template;
    protected $content = FALSE;
    protected $title;
    protected $vars;

    public function __construct() {
        $this->user = Auth::user();

    }

    public function renderOutput(){
        $this->vars = array_add($this->vars,'title', $this->title);

        $menu = $this->getMenu();
        $skills = $this->getSkill();
        $ports = $this->getPort();
        $usl = $this->getUsl();
        $navs = $this->getNav();
        $blogs = $this->getBlogs();

        $navigation = view(env('THEME').'.admin.navigation')->with([
            'menu' => $menu,
            'skills' => $skills,
            'ports' => $ports,
            'usl' => $usl,
            'navs' => $navs,
            'blogs' => $blogs
        ])->render();
        $this->vars =array_add($this->vars,'navigation', $navigation);

        if($this->content) {
            $this->vars = array_add($this->vars,'content', $this->content);
        }
        //dd( $this->vars);
        return view($this->template)->with($this->vars);

    }
    public function getSkill() {
        $skills = Skills::all();
        return $skills;
    }
    public function getPort() {
        $ports = Portfolio::all();
        return $ports;
    }
    public function getUsl() {
        $usl = Uslugy::all();
        return $usl;
    }
    public function getNav() {
        $navs = \App\Menu::all();
        return $navs;
    }
    public function getBlogs() {
        $blogs = Blog::all();
        return $blogs;
    }

    public function getMenu() {
        return Menu::make('adminMenu', function($menu) {
            //$menu->add('Статьи', array('route'=> 'admin.blogs.index'));
        });
    }
}
